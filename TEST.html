<!DOCTYPE html>
<html>

<head>
    <title>Test SystÃ¨me TÃ©lÃ©mÃ©trie</title>
    <style>
        body {
            font-family: monospace;
            background: #222;
            color: #fff;
            padding: 20px;
        }

        .test {
            margin: 10px 0;
            padding: 10px;
            background: #333;
            border-left: 3px solid #0f0;
        }

        .pass {
            border-left-color: #0f0;
            color: #0f0;
        }

        .fail {
            border-left-color: #f00;
            color: #f00;
        }
    </style>
</head>

<body>
    <h1>ðŸ§ª TEST SYSTÃˆME TÃ‰LÃ‰MÃ‰TRIE MB v2.0</h1>

    <div id="results"></div>

    <script>
        const results = [];

        function test(name, fn) {
            try {
                fn();
                results.push({ name, status: 'PASS', msg: 'OK' });
            } catch (e) {
                results.push({ name, status: 'FAIL', msg: e.message });
            }
        }

        // Test 1: VÃ©rifier que l'HTML a les bons IDs
        test('HTML - IDs prÃ©sents', () => {
            const ids = ['telem-time', 'telem-battery', 'telem-speed', 'telem-altitude',
                'telem-distance', 'telem-remaining', 'telem-waypoint',
                'telem-battery-bar', 'telem-progress-bar', 'telem-events-log',
                'telem-mission-params', 'telem-summary', 'mb-live-telemetry'];

            ids.forEach(id => {
                if (!document.getElementById(id) && typeof document === 'object') {
                    throw new Error(`Missing ID: ${id}`);
                }
            });
        });

        // Test 2: VÃ©rifier telemetryState
        test('TÃ©lÃ©mÃ©trie - Ã‰tat global', () => {
            if (typeof telemetryState !== 'object') {
                throw new Error('telemetryState not defined');
            }
            if (!telemetryState.hasOwnProperty('isRunning')) {
                throw new Error('Missing telemetryState.isRunning');
            }
        });

        // Test 3: VÃ©rifier fonctions
        test('Fonctions - startLiveTelemetry', () => {
            if (typeof startLiveTelemetry !== 'function') {
                throw new Error('startLiveTelemetry is not a function');
            }
        });

        test('Fonctions - simulationStep', () => {
            if (typeof simulationStep !== 'function') {
                throw new Error('simulationStep is not a function');
            }
        });

        test('Fonctions - calculatePowerConsumption', () => {
            if (typeof calculatePowerConsumption !== 'function') {
                throw new Error('calculatePowerConsumption is not a function');
            }
        });

        test('Fonctions - addEvent', () => {
            if (typeof addEvent !== 'function') {
                throw new Error('addEvent is not a function');
            }
        });

        // Afficher les rÃ©sultats
        function showResults() {
            const div = document.getElementById('results');
            let html = '';

            results.forEach(r => {
                html += `<div class="test ${r.status === 'PASS' ? 'pass' : 'fail'}">
                    [${r.status}] ${r.name}: ${r.msg}
                </div>`;
            });

            const passed = results.filter(r => r.status === 'PASS').length;
            const total = results.length;

            html += `<div style="margin-top: 20px; padding: 10px; background: #444;">
                <strong>RÃ‰SUMÃ‰: ${passed}/${total} tests rÃ©ussis</strong>
            </div>`;

            div.innerHTML = html;
        }

        // Lancer les tests aprÃ¨s chargement
        setTimeout(showResults, 100);
    </script>
</body>

</html>